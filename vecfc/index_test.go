package vecfc

import (
	"testing"

	"github.com/Fantom-foundation/lachesis-base/hash"
	"github.com/Fantom-foundation/lachesis-base/inter/dag"
	"github.com/Fantom-foundation/lachesis-base/inter/dag/tdag"
	"github.com/Fantom-foundation/lachesis-base/inter/pos"
	"github.com/Fantom-foundation/lachesis-base/kvdb/memorydb"
)

var (
	testASCIIScheme = `
	║       
	a000    
	║        ║       
	║        h000    
	║        ║        ║       
	║        ║        k000    
	║        ║        ║        ║       
	║        ║        ║        b000    
	║        ║        ║        ║        ║       
	║        ║        ║        ║        c000    
	║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ╠═══════ i000    
	║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        d000    
	║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ╠═══════ g000    
	║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ╠═══════ l000    
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ╠═══════─╫─═══════╬═══════─╫─══════ s000    
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	╠═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─══════─╫─══════─╫─══════ j000    
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        g001════─╫─═══════╬════════╣       
	║        ║        ║        ║        ║        ║        ║        ║║       ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║╚══════─╫─══════─╫─══════─╫─══════ o000    
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ╠═══════─╫─══════─╫─══════ c001════─╫─══════─╫─══════─╫─═══════╣        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        e000    
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ╠═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════ q000    
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ╠═══════─╫─══════ p000    
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        f000    
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ╠═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════ m000    
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ╠═══════─╫─══════─╫─══════─╫─══════ l001════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╣       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ╠═══════─╫─══════─╫─══════─╫─═══════╬═══════ n000    
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ╠═══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─══════─╫─══════ m001     ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       ║║        ║       
	║        ║        ║        b001════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─══════─╫─══════╝║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ╠═══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ n001    
	║        ║        ║        ║        ║        ║        ║        ║       ║║        ║        ║        ║        ║        ║        ║        ║        ║       ║║       
	║        ║        ║        ║        ║        ║        d001════─╫─══════╩╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════╝║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       ║║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        e001════─╫─═══════╬═══════─╫─══════─╫─══════╝║       
	║        ║        ║        ║        ║        ║        ║        ║        ║║       ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ╠═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫╩══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ f001     ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        i001════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─══════─╫─══════─╫─═══════╣        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       ║║       
	║        ║        k001════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─══════╝║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ╠═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ p001════─╫─══════─╫─═══════╣       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        b002════─╫─═══════╬═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╣        ║       
	║        ║        ║        ║        ║        ║        ║        ║║       ║║       ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║╚══════─╫╩══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ r000    
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║║       ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║╚═══════╬═══════ t000    
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ╠═══════─╫─══════ s001════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╣       
	║        ║       ║║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	a001════─╫─══════╩╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╣       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	╠═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─══════─╫─══════─╫─══════─╫─══════ t001    
	║        ║        ║       ║║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        h001════─╫─══════╩╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╣        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       ║║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        j001════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════╝║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ╠═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─══════─╫─══════ q001     ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ╠═══════ j002════─╫─══════─╫─═══════╣        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        k002════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╣        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ╠═══════─╫─══════─╫─═══════╬═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ o001     ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║       ║║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	a002════─╫─══════╩╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╣        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        c002════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─══════─╫─══════─╫─═══════╣        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	╠═══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ p002     ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        q002═════╬═══════─╫─══════─╫─══════─╫─══════─╫─═══════╣       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        b003════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─══════─╫─══════─╫─═══════╣        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        d002════─╫─══════─╫─═══════╬═══════─╫─═══════╣        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ╠═══════ g002════─╫─═══════╣        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ╠═══════─╫─══════─╫─═══════╬═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ m002     ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       ║║        ║        ║       ║║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        e002════╩╫─══════─╫─══════─╫─══════╝║        ║        ║        ║       
	║        ║        ║       ║║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        h002════─╫─══════╩╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╣        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        i002════─╫─═══════╬═══════─╫─══════─╫─══════─╫─══════─╫─═══════╣        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ╠════════╬═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ t002    
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║║       ║        ║        ║        ║        ║        ║        ║        ║       3║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║╚══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ r001════╝║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	╠═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ l002════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╣        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ╠═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ n002═════╣        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ╠═══════─╫─══════─╫─══════─╫─══════─╫─══════ g003════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╣        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	a003════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─═══════╣        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        h003════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╣        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       ║║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ╠═══════─╫─══════─╫─══════ o002════─╫─══════╝║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ╠═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ j003═════╣        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║║       ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║╚══════─╫─══════─╫─══════─╫─══════─╫─══════ d003════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╣        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ╠═══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ n003     ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       ║║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        f002════─╫─══════─╫─═══════╬═══════╝║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        s002════─╫─══════─╫─══════─╫─═══════╬═══════─╫─═══════╣        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        k003════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬════════╣        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ╠═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ l003════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╣        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	a004════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─═══════╣        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       ║║        ║        ║       
	║        ║        ╠═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ m003════╝║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ╠═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ s003════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╣        ║        ║        ║       
	║║       ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║╚══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─══════─╫─══════ t003    
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	╠═══════─╫─══════ k004════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╣        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	╠═══════─╫─══════─╫─══════ b004════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╣       
	║        ║        ║        ║        ║        ║        ║        ║        ║║       ║        ║║       ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║╚══════─╫─══════─╫╩══════─╫─══════─╫─══════─╫─══════─╫─══════ f003     ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║║       ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       3║       
	║        ║        ║        ║        ║        ║        ║╚══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ r002════╝║       
	║        ║        ║        ║║       ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║╚══════ c003════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╣        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       ║║        ║        ║        ║        ║       
	║        ║        ║        ║        ╠═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ e003════─╫─══════─╫─══════╝║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        i003════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╣        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        o003═════╬═══════─╫─══════─╫─══════─╫─══════─╫─═══════╣        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ╠═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─══════ q003     ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ╠═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ p003════─╫─══════─╫─══════─╫─═══════╣        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ╠═══════ c004════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╣        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ╠════════╬═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ j004     ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        l004════─╫─═══════╬════════╣        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ╠═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════ o004     ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ╠════════╬═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ t004    
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ╠═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─══════─╫─══════─╫─══════ p004     ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       ║║       
	║        ║        ║        ║        ╠═══════─╫─══════ d004════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════╝║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	╠═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ m004     ║        ║        ║       
	║        ║        ║║       ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       ║║        ║        ║        ║        ║        ║       
	║        ║        ║╚══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ e004════─╫─══════╝║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       ║║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        g004════─╫─══════─╫─══════─╫─══════╩╫─═══════╣        ║        ║        ║        ║        ║        ║        ║       
	║        ║       ║║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        h004════╩╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╣        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║       ║║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        i004════─╫─══════─╫─══════╩╫─══════─╫─══════─╫─══════─╫─═══════╣        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ╠════════╬═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════ q004     ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║║       ║        ║        ║        ║        ║║       ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║╚══════─╫─══════─╫─══════─╫─══════─╫─══════─╫╩══════─╫─══════─╫─══════─╫─══════─╫─══════ f004     ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	╠═══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─══════ n004     ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║║       ║        ║        ║        ║        ║        ║║       ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║╚══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫╩══════─╫─══════─╫─══════ r003     ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ╠═══════─╫─══════─╫─══════─╫─══════─╫─═══════╬═══════─╫─══════─╫─══════ r004     ║       
	║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║        ║       
	║        ║        ║        ║        ║        ╠═══════─╫─══════─╫─══════─╫─══════ s004════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─══════─╫─═══════╣        ║       
   
`
)

func BenchmarkIndex_Add(b *testing.B) {
	b.StopTimer()
	ordered := make(dag.Events, 0)
	nodes, _, _ := tdag.ASCIIschemeForEach(testASCIIScheme, tdag.ForEachEvent{
		Process: func(e dag.Event, name string) {
			ordered = append(ordered, e)
		},
	})
	validatorsBuilder := pos.NewBuilder()
	for _, peer := range nodes {
		validatorsBuilder.Set(peer, 1)
	}
	validators := validatorsBuilder.Build()
	events := make(map[hash.Event]dag.Event)
	getEvent := func(id hash.Event) dag.Event {
		return events[id]
	}
	for _, e := range ordered {
		events[e.ID()] = e
	}

	vecClock := NewIndex(func(err error) { panic(err) }, LiteConfig())
	vecClock.Reset(validators, memorydb.New(), getEvent)

	for i := 0; i < b.N; i++ {
		b.StopTimer()
		vecClock.Reset(validators, memorydb.New(), getEvent)
		b.StartTimer()
		for _, e := range ordered {
			err := vecClock.Add(e)
			if err != nil {
				panic(err)
			}
			i++
			if i >= b.N {
				break
			}
		}
	}
}

// func TestGen(t *testing.T) {
// 	codegen4AddBenchmark()
// }

// // codegen4AddBenchmark is for test data generation.
// func codegen4AddBenchmark() {
// 	nodes := tdag.GenNodes(20)
// 	ee := tdag.GenRandEvents(nodes, 5, 3, nil)

// 	events := dag.Events{}
// 	for _, e := range ee {
// 		events = append(events, e...)
// 	}

// 	scheme0, _ := tdag.DAGtoASCIIscheme(events)

// 	fmt.Println(scheme0)
// }
